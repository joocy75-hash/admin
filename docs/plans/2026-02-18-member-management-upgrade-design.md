# 회원관리 PRISM 수준 업그레이드 설계서

> **작성일**: 2026-02-18
> **참조 사이트**: PRISM (adm.prism88.com)
> **목표**: 회원관리 전체를 PRISM과 동일 수준으로 업그레이드
> **작업 방식**: 단계별 진행 + 매 단계 검증 + CLAUDE.md 인수인계

---

## Phase 1: 회원 목록 페이지 리뉴얼 + 슬라이드 패널

### 1-1. 회원 목록 페이지 (users/page.tsx) 리뉴얼
**현재**: 트리 테이블만 존재, 요약 카드 없음, 필터 미흡
**목표**: PRISM과 동일한 구조

- [ ] 요약 카드 3개: 전체회원 수, 정상 수, 총 보유금
- [ ] 검색: 아이디/닉네임/연락처 통합 검색
- [ ] 상태 필터 버튼: 전체, 정상, 가입대기, 정지, 삭제
- [ ] 등급 필터 버튼: 전체등급, VIP, 일반
- [ ] 테이블 컬럼 PRISM 동일: 회원정보(아이디+닉네임), 메모, 회원등급, 동기화, 그룹, 회원유형, 파트너, 보유금, 포인트, 지급/회수
- [ ] 액션 버튼: 잔액 동기화, 대량 생성, 회원 추가
- [ ] 하단: 정지회원/삭제회원 일괄, 페이지네이션(10/20/30/50/100건)
- [ ] 이름순 정렬 토글
- [ ] 컬럼 커스터마이징 버튼

### 1-2. 슬라이드 패널 (Sheet) 구현
**현재**: 별도 페이지 (/dashboard/users/[id])
**목표**: 목록 위에 오버레이 슬라이드 패널

- [ ] shadcn/ui Sheet 컴포넌트 활용 (right side, 넓이 900px)
- [ ] 회원 클릭 → Sheet open, 기존 8탭 컴포넌트 재활용
- [ ] 공통 헤더: 아이디 + 회원/파트너 뱃지 + 상태 + 닉네임 · 레벨
- [ ] 하단 액션: 수정, 비밀번호 초기화, 비밀번호 지정, 정지, 삭제
- [ ] X 버튼으로 닫기, ESC 키 지원
- [ ] 기존 [id]/page.tsx도 유지 (직접 URL 접속용)

### 1-3. 검증 체크리스트
- [ ] 회원 목록 정상 렌더링
- [ ] 필터(상태/등급) 동작
- [ ] 검색 동작
- [ ] 회원 클릭 → 슬라이드 패널 열림
- [ ] 8탭 전환 정상
- [ ] 패널 닫기 → 목록 복귀
- [ ] 빌드 성공 (next build --webpack)
- [ ] CLAUDE.md 업데이트

---

## Phase 2: 상단 실시간 통계바

### 2-1. 공통 통계바 컴포넌트
**현재**: 없음
**목표**: PRISM과 동일한 상단 통계바 (모든 페이지 공통)

- [ ] 표시 항목: 전체/베팅회원, 신규/탈퇴, 포인트전환, 입금, 출금, 입출손익, 베팅, 당첨, 베팅손익
- [ ] "N초전" 자동 갱신 타이머
- [ ] 게임별 상세 드롭다운
- [ ] 새로고침 버튼
- [ ] dashboard/layout.tsx에 배치

### 2-2. 백엔드 API
- [ ] GET /api/v1/dashboard/today-stats (오늘 통계 전용 엔드포인트)
- [ ] 응답: 가입/탈퇴, 입금건수/금액, 출금건수/금액, 베팅건수/금액, 당첨금액

### 2-3. 퀵 액션 아이콘 4개
- [ ] 입금, 출금, 1:1 문의, 쪽지 — 즉시 해당 페이지 이동
- [ ] 대기 건수 뱃지 표시

### 2-4. 검증 체크리스트
- [ ] 통계바 모든 페이지에서 표시
- [ ] 자동 갱신 동작
- [ ] 퀵 액션 링크 정상
- [ ] 빌드 성공
- [ ] CLAUDE.md 업데이트

---

## Phase 3: 실시간접속 + 가입대기 페이지

### 3-1. 실시간접속 페이지 (/dashboard/users/realtime)
**현재**: 없음
**참조**: PRISM /adm/users/realtime

- [ ] 현재 접속 중인 회원 목록 (WebSocket/SSE 기반)
- [ ] 접속 시간, IP, 접속 기기 표시
- [ ] 자동 갱신 (10초 간격)
- [ ] 검색/필터 기능

### 3-2. 가입대기 페이지 (/dashboard/users/pending)
**현재**: 없음
**참조**: PRISM /adm/users/pending

- [ ] 가입 신청 후 승인 대기 회원 목록
- [ ] 승인/거절 액션 버튼
- [ ] 상세 정보 미리보기

### 3-3. 로그인기록 별도 페이지 (/dashboard/users/login-history)
**현재**: 회원 상세 탭 내에만 존재
**참조**: PRISM /adm/users/login-history

- [ ] 전체 로그인 기록 통합 조회
- [ ] IP, UA, 기기, OS 필터
- [ ] 기간 필터

### 3-4. 백엔드 API
- [ ] GET /api/v1/users/online (실시간 접속자)
- [ ] GET /api/v1/users/pending (가입대기)
- [ ] PUT /api/v1/users/{id}/approve (가입승인)
- [ ] PUT /api/v1/users/{id}/reject (가입거절)
- [ ] GET /api/v1/users/login-history (전체 로그인기록)

### 3-5. 사이드바 메뉴 업데이트
- [ ] 회원관리 하위: 파트너, 전체회원, 실시간접속, 가입대기, 로그인기록

### 3-6. 검증 체크리스트
- [ ] 실시간접속 페이지 렌더링 + 자동 갱신
- [ ] 가입대기 목록 + 승인/거절 동작
- [ ] 로그인기록 조회 + 필터
- [ ] 사이드바 메뉴 정상
- [ ] 빌드 성공
- [ ] CLAUDE.md 업데이트

---

## Phase 4: 머니/포인트 내역 세분화

### 4-1. 머니내역 하위 메뉴 5개
**현재**: 단일 페이지
**목표**: PRISM과 동일

- [ ] /dashboard/money-history — 전체내역
- [ ] /dashboard/money-history/admin — 관리자 지급/차감
- [ ] /dashboard/money-history/partner — 파트너간 지급/차감
- [ ] /dashboard/money-history/user — 유저머니 지급/차감
- [ ] /dashboard/money-history/game — 게임 동기화

### 4-2. 포인트내역 하위 메뉴 3개
- [ ] /dashboard/money-history/rolling — 롤링내역
- [ ] /dashboard/money/point — 포인트전환
- [ ] /dashboard/money-history/point — 포인트내역

### 4-3. 각 페이지 공통 구조
- [ ] 요약 카드 (총 건수, 총 금액 등)
- [ ] 기간 필터 (오늘/어제/7일/30일/달력)
- [ ] 유형별 필터
- [ ] 테이블 (일시, 아이디, 유형, 금액, 이후잔액, 메모)
- [ ] 페이지네이션

### 4-4. 백엔드 API 확장
- [ ] GET /api/v1/money-logs?type=admin (유형별 필터 파라미터)
- [ ] GET /api/v1/point-logs?type=rolling (유형별 필터)

### 4-5. 사이드바 메뉴 업데이트
- [ ] 머니내역 > 5개 하위메뉴
- [ ] 포인트내역 > 3개 하위메뉴

### 4-6. 검증 체크리스트
- [ ] 각 머니 하위 페이지 렌더링 + 필터 + 페이지네이션
- [ ] 각 포인트 하위 페이지 동작
- [ ] 사이드바 메뉴 정상
- [ ] 빌드 성공
- [ ] CLAUDE.md 업데이트

---

## Phase 5: 파트너 관리 강화 + 기타 UI 개선

### 5-1. 파트너 관리 페이지 개선
- [ ] 요약 카드 4개: 전체 파트너, 총 하부회원, 머니(하부포함), 포인트(하부포함)
- [ ] 등급 필터 5단계: 본사, 부본사, 지사, 총판, 매장
- [ ] 하부 잔액 동기화 버튼
- [ ] 상위 변경 버튼
- [ ] 정산내역 바로가기
- [ ] 하단 레벨별 통계 (본사 N명, 부본사 N명 ...)
- [ ] 머니(하부), 포인트(하부) 컬럼 추가

### 5-2. 회원 상세 슬라이드 패널 고도화
- [ ] 머니 지급/회수 인라인 다이얼로그
- [ ] 포인트 지급/회수 인라인 다이얼로그
- [ ] 잔액 새로고침 버튼 (머니 탭)
- [ ] 머니 탭 > 게임시작/게임종료 필터 추가

### 5-3. 기타 UI 개선
- [ ] 다크 테마 색상 PRISM 참조 통일
- [ ] 회원 목록 체크박스 (일괄 선택)
- [ ] 지급/회수 버튼 인라인 추가

### 5-4. 검증 체크리스트
- [ ] 파트너 요약/필터/액션 동작
- [ ] 회원 상세 지급/회수 다이얼로그 동작
- [ ] 빌드 성공
- [ ] CLAUDE.md 최종 업데이트

---

## 추가 제안 (내 생각)

PRISM에는 없지만 추가하면 좋을 기능들:

### A. 회원 활동 타임라인 (Tab 9 제안)
- 모든 활동(로그인/베팅/입출금/문의)을 시간순으로 통합 표시
- 관리자가 한 화면에서 회원의 전체 행동 패턴 파악 가능

### B. 회원 메모 시스템 강화
- PRISM은 단순 텍스트 메모만 있음
- 우리는 타임스탬프 + 작성자 포함 메모 이력 관리
- 관리자간 인수인계에 유용

### C. 회원 통계 대시보드 (개인별)
- 일별/주별/월별 베팅 패턴 차트
- 입출금 추이 그래프
- 위험 신호 자동 감지 (급격한 베팅 증가 등)

### D. 회원 그룹 태그 시스템
- PRISM의 "그룹" 기능을 더 발전시켜
- 복수 태그 지정 가능 (VIP, 주의회원, 이벤트대상 등)
- 태그별 필터 + 일괄 액션

### E. 엑셀 내보내기
- 회원 목록, 베팅내역, 머니/포인트 내역
- 기간별 필터 적용 후 CSV/Excel 다운로드

---

## 작업 규칙

### 매 Phase 완료 시 필수 체크
1. ✅ 검증 체크리스트 모든 항목 통과
2. ✅ `npx next build --webpack` 성공
3. ✅ 이 문서의 해당 Phase [ ] → [x] 변경
4. ✅ CLAUDE.md 진행 상황 업데이트
5. ✅ 인수인계 문서 작성/갱신

### 중단 대응
- 각 Phase는 독립적으로 동작하도록 설계
- Phase N이 완료되면 해당 기능은 바로 사용 가능
- 중단 후 재개 시 이 문서 + CLAUDE.md만 읽으면 현재 상태 파악 가능

### 에이전트 팀 구성
- **리더**: 전체 오케스트레이션 + 검증
- **백엔드 에이전트**: API 구현 + DB 스키마
- **프론트엔드 에이전트**: UI 컴포넌트 + 훅
- 모든 에이전트 opus 4.6 사용

---

## 우선순위 요약

| 순서 | Phase | 핵심 변경 | 예상 규모 |
|------|-------|----------|----------|
| 1 | 목록 리뉴얼 + 슬라이드 패널 | 회원관리 핵심 UX 변경 | 대 |
| 2 | 상단 실시간 통계바 | 공통 컴포넌트 + API | 중 |
| 3 | 실시간접속 + 가입대기 | 새 페이지 3개 + API 5개 | 대 |
| 4 | 머니/포인트 세분화 | 하위 메뉴 8개 | 중 |
| 5 | 파트너 강화 + UI 개선 | 기존 개선 | 중 |
